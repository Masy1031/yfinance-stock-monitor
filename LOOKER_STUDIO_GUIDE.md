# Looker Studio データ取り込み完全ガイド

## 調査結果：最適なデータ取り込み方法

### 1. 推奨データソース

#### **🥇 最推奨：Google Sheets経由**
- **自動更新**: 15分間隔で自動更新
- **リアルタイム性**: データの変更が即座に反映
- **コラボレーション**: 複数人でのデータ編集が可能
- **制限**: ファイルサイズ制限なし（実質的）

#### **🥈 代替案：CSVファイル直接アップロード**
- **シンプル**: 直接的なアップロード
- **制限**: 手動更新が必要
- **ファイルサイズ**: 100MB制限

### 2. 出力データの種類と用途

#### **📊 Dashboard Data (dashboard_data.csv)**
**用途**: メインダッシュボード用
**特徴**: 
- 現在の株価情報
- セクター別分析
- パフォーマンス指標
- カテゴリ分類済み

**主要フィールド**:
```
- stock_symbol: 株式シンボル
- company_name: 会社名
- sector: セクター
- current_price: 現在価格
- price_change_percent: 価格変動率
- volume: 取引量
- market_cap_category: 時価総額カテゴリ
- change_category: 変動カテゴリ
```

#### **📈 Time Series Data (time_series_data.csv)**
**用途**: 時系列チャート用
**特徴**:
- 日次価格履歴
- 価格変動の推移
- 取引量の変化

**主要フィールド**:
```
- date: 日付
- stock_symbol: 株式シンボル
- open_price: 始値
- high_price: 高値
- low_price: 安値
- close_price: 終値
- volume: 取引量
- price_change_percent: 日次変動率
```

#### **📋 Summary Data (summary_data.csv)**
**用途**: サマリーテーブル用
**特徴**:
- 簡略化された情報
- クイック分析用
- モバイル表示に最適

#### **🎯 Performance Data (performance_data.csv)**
**用途**: パフォーマンス分析用
**特徴**:
- 各期間のパフォーマンス
- リスク指標
- 比較分析用

## 3. Looker Studioへの取り込み手順

### 方法1: Google Sheets経由（推奨）

#### ステップ1: Google Sheets API設定
1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 新しいプロジェクトを作成
3. Google Sheets APIを有効化
4. サービスアカウントを作成
5. サービスアカウントキーをダウンロード
6. `service_account_key.json`として保存

#### ステップ2: データのエクスポート
```bash
python looker_studio_optimized.py
# オプション6を選択（Google Sheets含む）
```

#### ステップ3: Looker Studioでの接続
1. [Looker Studio](https://lookerstudio.google.com/)にアクセス
2. 「作成」→「レポート」を選択
3. 「データを追加」→「Google スプレッドシート」を選択
4. 作成されたスプレッドシートを選択
5. 適切なワークシートを選択

### 方法2: CSVファイル直接アップロード

#### ステップ1: データのエクスポート
```bash
python looker_studio_optimized.py
# オプション5を選択（CSVのみ）
```

#### ステップ2: Looker Studioでのアップロード
1. [Looker Studio](https://lookerstudio.google.com/)にアクセス
2. 「作成」→「レポート」を選択
3. 「データを追加」→「ファイルをアップロード」を選択
4. CSVファイルを選択してアップロード
5. データ型を確認・調整

## 4. 推奨ダッシュボード構成

### メインダッシュボード
1. **株価サマリーテーブル**
   - データソース: `dashboard_data.csv`
   - 表示項目: 会社名、現在価格、変動率、セクター

2. **セクター別パフォーマンス**
   - データソース: `dashboard_data.csv`
   - チャートタイプ: 棒グラフ
   - ディメンション: `sector_category`
   - 指標: `price_change_percent`の平均

3. **価格変動分布**
   - データソース: `dashboard_data.csv`
   - チャートタイプ: 円グラフ
   - ディメンション: `change_category`

4. **時系列価格チャート**
   - データソース: `time_series_data.csv`
   - チャートタイプ: 折れ線グラフ
   - ディメンション: `date`
   - 指標: `close_price`

### 詳細分析ダッシュボード
1. **個別株式分析**
   - データソース: `time_series_data.csv`
   - フィルター: 株式シンボル

2. **パフォーマンス比較**
   - データソース: `performance_data.csv`
   - チャートタイプ: 棒グラフ
   - 指標: 各期間のパフォーマンス

3. **リスク分析**
   - データソース: `performance_data.csv`
   - 指標: ボラティリティ、最大・最小価格

## 5. データ更新の自動化

### Google Sheets経由の場合
- **自動更新**: 15分間隔で自動更新
- **手動更新**: 不要

### CSVファイル経由の場合
- **手動更新**: スクリプト実行後にCSVファイルを再アップロード
- **自動化**: スケジューラーを使用（要設定）

## 6. トラブルシューティング

### よくある問題

#### データが表示されない
- **原因**: データ型の設定ミス
- **解決**: データソース設定でデータ型を確認

#### 更新されない
- **原因**: キャッシュの問題
- **解決**: データソースの「更新」ボタンをクリック

#### エラーが発生する
- **原因**: データの形式問題
- **解決**: CSVファイルの文字エンコーディングを確認

## 7. 最適化のコツ

### パフォーマンス向上
1. **不要なデータの削除**: 使用しない列を除外
2. **データの集約**: 必要に応じてデータを事前集約
3. **フィルターの活用**: 必要なデータのみ表示

### 可視化の改善
1. **カテゴリ分類**: データを事前にカテゴリ化
2. **計算フィールド**: Looker Studio内で計算フィールドを作成
3. **色分け**: セクターやパフォーマンスで色分け

## 8. セキュリティ考慮事項

### データの機密性
- 株価データは公開情報ですが、大量のデータ取得は注意が必要
- Yahoo Financeの利用規約を遵守

### API制限
- 適切な間隔でデータを取得
- エラーハンドリングを実装

## 9. 次のステップ

### 高度な機能
1. **アラート設定**: 特定の条件での通知
2. **予測分析**: 機械学習による価格予測
3. **ポートフォリオ分析**: 複数株式の組み合わせ分析

### 統合
1. **他のデータソース**: ニュース、経済指標との統合
2. **API連携**: リアルタイムデータの取得
3. **モバイル対応**: レスポンシブデザインの実装
